<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="../../assets/css/booked_list.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/uuid@8.3.2/dist/umd/uuidv4.min.js"></script>
    <title>Booked_pgs</title>
</head>

<body>
    <header>
        <div class="header">
            <div id="container">
                <nav>
                    <ul>
                        <div class="magic">
                            <li><img  src="../../assets/images/Screenshot__17_-removebg-preview.png" alt="photo" height="60px" width="100%"></a></li>
                        </div> </li>
                       
                        <li><a href="../../pages/products/updated Boys.html">Boys pgs</a></li>
                        <li><a href="../../pages/products/updated for girls.html">Girls pgs</a></li>
                        <li><a href="../../pages/products/updated for both.html">Both Gender living pg</a></li>                        
                    
                   <li><a href="../../pages/homepage/my profile.html"> <i class="fa fa-user" style="font-size:48px;color:red"></i></i></a>
                    
                      
                        <li><a href="../../pages/homepage/review.html">Reviews</a></li>

                    </ul>


                    </li>

                </nav>
            </div>


        </div>
    </header>
    <div class="section"></div>



    <script>

        let roomBookRequest = JSON.parse(localStorage.getItem("room_book_request"));
        console.log(roomBookRequest);

        let customer = JSON.parse(localStorage.getItem("userId"));



        // conosle.log(product_id);
        let filterdata = roomBookRequest.filter(e => e.customer_id == customer);
        console.log(filterdata);



        for (i = 0; i < filterdata.length; i++) {

            let div_border = document.createElement("div");
            div_border.setAttribute("class", "border");
            console.log(div_border);
            document.querySelector(".section").append(div_border);


            // let div_detail = document.createElement("div");
            // div_detail.setAttribute("class", "pg_detail");
            // div_border.append(div_detail);

            let div_image = document.createElement("div");
            div_image.setAttribute("class", "detail");
            div_border.append(div_image);




            let h2 = document.createElement("h2");
            h2.setAttribute("class", "pg_name");
            div_image.append(h2);

            let sharing_name = document.createElement("h3");
            sharing_name.setAttribute("class", "name_of_pg");
            sharing_name.setAttribute("id", "name");
            sharing_name.innerText = filterdata[i]["pgname"];
            h2.append(sharing_name);

            let div_two = document.createElement("div");
            div_two.setAttribute("class", "moredetail");
            h2.append(div_two);


            let sharing_room = document.createElement("h4");
            sharing_room.setAttribute("id", "share");
            sharing_room.innerHTML = filterdata[i]["typeOfShare"];
            div_two.append(sharing_room);

           let equaldata = document.createElement("div");
           equaldata.setAttribute("class","data");
           sharing_room.append(equaldata);

            let monthly_rent = document.createElement("p");
            monthly_rent.setAttribute("id", "rent");
            monthly_rent.innerText = "status:";
            equaldata.append(monthly_rent);



            let value = "";
            let status = filterdata[i]["status"];

            if (status === 1) {
                value = "Not seen";
            } else if (status === 2) {
                value = "Accepted";
            } else if (status === 0) {
                value = "Rejected";
            }

            let statusDev = document.createElement("p");
            statusDev.setAttribute("id", "status");
            statusDev.innerText = value;
            equaldata.append(statusDev);
            
           
            button_del = document.createElement("button");
            button_del.setAttribute("type", "submit");
            button_del.setAttribute("class", "delete"); 
            button_del.setAttribute("data-del", filterdata[i]["my_uuid"]);
            // button_del.setAttribute("onclick", "del()")
           button_del.innerHTML = "Delete";
           div_two.append(button_del);



        };
        let del_pgs = document.querySelectorAll("button.delete");
    del_pgs.forEach(function (check) {
        check.addEventListener("click", function () {
            let unique_id = this.dataset.del;
            localStorage.setItem("request_id", JSON.stringify(unique_id));

            if (confirm("Are you sure to delete this pg?")){
                let id = JSON.parse(localStorage.getItem("request_id"));
                console.log(id);
                let requests = JSON.parse(localStorage.getItem("room_book_request"));
                console.log(requests);
                let pg_check = requests.find(e => e.request_id == id);
                console.log(pg_check);
                let pgs = requests.indexOf(pg_check); 
                requests.splice(pgs, 1);
                console.log(pgs);
                localStorage.setItem("room_book_request", JSON.stringify(requests));
                location.reload()
            }

        })
    })
   
     












    </script>

</body>

</html>