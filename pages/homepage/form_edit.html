<!DOCTYPE html>
<html lang="en">
    <head>
    
        <link rel="stylesheet" href="../../assets/css/form_read.css">
        <link rel="stylesheet" href="../../assets/css/header.css">
        <link rel="stylesheet" href="../../assets/css/footer.css">
        <meta charset="UTF-8">   
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <title>Form_edit</title>
        <script src="https://cdn.jsdelivr.net/npm/uuid@8.3.2/dist/umd/uuidv4.min.js"></script>
    </head>
    <body>
        <header>

        </header>
  
        <form role="form" onsubmit="update(event)">
            <div class="readform">
        
                <div class="container">
          
                    <label for="name">
                        <b> 1.pg_Name</b>
                    </label>
                    <input type="text" placeholder="pg_name" id="name"id="name" disabled >
                    <br>
                    <br>
       
                                   

                 
                <div class="section">

                    <label for="name">
                        <b> 3.Deposite amount</b>
                    </label>
                    <input type="number" name="fname" id="amount" min="4000" max="10000" pattern="[0-9]+" required>
                    <br>
                    <br>
      
                    <label for="sharing">
                        <b>4. Notice Period</b><br>
                    </label>
                    <input  type="text"id="period" placeholder="example:10 days " min="10 days " max="30 days " required>
                    <br>
                    <br>
    
                    <label for="sharing">
                        <b>5. Closing Time </b><br>
                    </label>
                    <input  type="text" id="time" placeholder ="eample:11:00 PM"pattern="^(0?[1-9]|1[0-2]):([0-5]\d) (AM|PM)$" required>
                    <br>
                    <br>

                    <label for="sharing">
                        <b>6.Available For</b>
                    </label>
                    <input type="text"id="available" >
                    <br>
                    <br>
  

                 
                </div>
                    <label for="sharing">
                        <b>7.No.of Beds</b> 
                    </label>
                    <input type="number"id="beds" required placeholder="example: 60 beds" min="20" max="200">
                    <br>
                    <br>

                  

                    <label for="pg_name">
                        <b>13.Image</b><br>
                    </label>
                    <input type ="url" id="image" >
                    <br>
                    <br>

                    <label for="address">
                        <b>14. Address</b>
                    </label>
                    <br>
                    <textarea type="text"id="address" required></textarea>
                    <br>
                </div>
            </div>
        
            <div class="last">
                <!-- <button type="button"  onclick="del(event)"class="registerbtn" >delete</button> -->
                <button type="submit" class="registerbtn">submit</button>
          
            </div>
        </form>
       
        <script src="../../assets/js/header.js"></script>
        <script src ="/assets/js/footer.js"></script>
        <script>
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const my_uuid = urlParams.get("my_uuid");
        const details = JSON.parse(localStorage.getItem("pgdetails"));
        console.log(details);

function login_data(e) {
  return e.my_uuid == my_uuid;
}
const user_data = details.find(login_data);
console.log(details);

document.getElementById("name").value = user_data.pg_details.name;

document.getElementById("beds").value = user_data.pg_details.beds;
document.getElementById("time").value = user_data.pg_details.time;
document.getElementById("period").value = user_data.pg_details.period;
document.getElementById("available").value = user_data.pg_details.available;
document.getElementById("image").value = user_data.pg_details.image;
document.getElementById("address").value = user_data.pg_details.address;
document.getElementById("amount").value = user_data.pg_details.advance;
// document.getElementById("secondname").value = user_data["secondname"];

// document.getElementById("parking").value = user_data.facilities_data[0];
// document.getElementById("tv").value = user_data.facilities_data[2];
// document.getElementById("wifi").value = user_data.facilities_data[4];
// document.getElementById("food").value = user_data.facilities_data[6];
// document.getElementById("fridge").value = user_data.facilities_data[8];
// // more images //
// document.getElementById("image1").value =
//   user_data.facilities_data[1];
// document.getElementById("image2").value =
//   user_data.facilities_data[3];
// document.getElementById("lastimage").value =
//   user_data.facilities_data[5];
// document.getElementById("image4").value =
//   user_data.facilities_data[7];

function update(e) {
  e.preventDefault();

  const up_name = document.getElementById("name").value;
  const up_address = document
    .getElementById("address")
    .value.trim()
    .split(/\s+/g)
    .join(" ");
 
  const up_image = document.getElementById("image").value;
  const up_beds = document.getElementById("beds").value;
 
  const up_available = document.getElementById("available").value;
 
  const up_period = document.getElementById("period").value;
  const up_time = document.getElementById("time").value;
  const up_amount = document.getElementById("amount").value;
  // let up_secondname = document.getElementById("secondname").value
  

            user_data.pg_details.name = up_name;
            user_data.pg_details.address = up_address;
            user_data.pg_details.beds = up_beds;
            
            user_data.pg_details.image = up_image;
            
            user_data.pg_details.available = up_available;
            
            user_data.pg_details.period = up_period;
            user_data.pg_details.time = up_time;
            // user_data.amount = up_amount;
  // user_data["secondname"] = up_secondname;

  

   localStorage.setItem("pgdetails", JSON.stringify(details));

  window.location.href = "../products/seller_product.html";
}
// getting data from local storage //
const arrayofdata = details.find((e) => e.my_uuid == my_uuid);
      console.log(arrayofdata);

if (arrayofdata&& Array.isArray(arrayofdata.share_data)) {
  // Access the array details within the object
  const share_data = arrayofdata.share_data;

  console.log(share_data);
  } else {
  console.log("Invalid or missing data in local storage");
   }


const div_border = document.createElement("div");
div_border.setAttribute("class", "border");
console.log(div_border);
document.querySelector(".readform").append(div_border);

// Create the label element for "Type of share"
 if (arrayofdata && Array.isArray(arrayofdata.share_data)) {
  const arrayshare_data = arrayofdata.share_data;
  for (let i = 0; i < arrayshare_data.length; i++) {
    const typeOfShareLabel = document.createElement("label");
    typeOfShareLabel.setAttribute("for", "typeofshare");
    typeOfShareLabel.innerHTML = "<b>Type of share</b>";
    div_border.append(typeOfShareLabel);

    // Create the input element for "Type of share"
    const typeOfShareInput = document.createElement("input");
    typeOfShareInput.setAttribute("type", "text");
    typeOfShareInput.setAttribute("id", "typeofshare");
   
    typeOfShareInput.value = arrayshare_data[i].name;
    typeOfShareInput.setAttribute("required", true);
    div_border.append(typeOfShareInput);

    // Create line break elements
    div_border.append(document.createElement("br"));
    div_border.append(document.createElement("br"));

    // Create the label element for "Rent"
    const rentLabel = document.createElement("label");
    rentLabel.setAttribute("for", "onesharerent");
    rentLabel.innerHTML = "<b>Rent</b> <br>";
    div_border.append(rentLabel);

    // Create the input element for "Rent"
    const rentInput = document.createElement("input");
    rentInput.setAttribute("type", "text");
    rentInput.setAttribute("id", "onesharerent");
    rentInput.setAttribute("min", "1000");
    rentInput.setAttribute("max", "30000");
    rentInput.setAttribute("pattern", "[0-9]+");
    rentInput.setAttribute("required", true);
    rentInput.value = arrayshare_data[i].rent;
    div_border.appendChild(rentInput);


    div_border.append(document.createElement("br"));
    div_border.append(document.createElement("br"));

    const imageLabel = document.createElement("label");
    imageLabel.setAttribute("for", "onesharerent");
    imageLabel.innerHTML = "<b>Image</b> <br>";
    div_border.append(imageLabel);

    // Create the input element for "Image"
    const imageInput = document.createElement("input");
    imageInput.setAttribute("type", "text");
    imageInput.setAttribute("id", "onesharerent");
    imageInput.setAttribute("min", "1000");
    imageInput.setAttribute("max", "30000");
   
    imageInput.setAttribute("required", true);
    imageInput.value = arrayshare_data[i].image;
    div_border.append(imageInput);

    div_border.append(document.createElement("br"));
    div_border.append(document.createElement("br"));

    typeOfShareInput.addEventListener("input", function () {
      arrayshare_data[i].name = typeOfShareInput.value;
      updateLocalStorage();
    });

    rentInput.addEventListener("input", function () {
      arrayshare_data[i].rent = rentInput.value;
      updateLocalStorage();
    });

    imageInput.addEventListener("input", function () {
      arrayshare_data[i].image = imageInput.value;
      updateLocalStorage();
    });
  }
} else {
  console.log("not valid");
}

// Function to update localStorage with the updated data
function updateLocalStorage() {
  if (localStorage) {
    localStorage.setItem("pgdetails", JSON.stringify(arrayofdata));
  }
}


// .......................................................................another for loop ......................................

if (arrayofdata && Array.isArray(arrayofdata.facilities_data)) {
  // Access the array details within the object
  const facilities_data = arrayofdata.facilities_data;

  console.log(facilities_data);
} else {
  console.log("Invalid or missing data in local storage");
}

const div_borders = document.createElement("div");
div_borders.setAttribute("class", "border");
console.log(div_borders);
document.querySelector(".container").append(div_borders);

// Create the label element for "Facility of the pg"
if (arrayofdata && Array.isArray(arrayofdata.facilities_data)) {
  const arrayshare = arrayofdata.facilities_data;
  for (let j = 0; j< arrayshare.length; j++) {

    const rentLabel = document.createElement("label");
    rentLabel.setAttribute("for", "onesharerent");
    rentLabel.innerHTML = "<b>Facility of the pg</b> <br>";
    div_borders.append(rentLabel);

    // Create the input element for "Facility"
    const imageInput = document.createElement("input");
    imageInput.setAttribute("type", "text");
    imageInput.setAttribute("id", "onesharerent");
    imageInput.setAttribute("required", true);
    imageInput.value = arrayshare[j].image;
    div_borders.append(imageInput);

    div_borders.append(document.createElement("br"));

    const imageLabel = document.createElement("label");
    imageLabel.setAttribute("for", "image");
    imageLabel.innerHTML = "<b>Image</b> <br>";
    div_borders.append(imageLabel);

    // Create the input element for "Facility"
    const rentInput = document.createElement("input");
    rentInput.setAttribute("type", "text");
    rentInput.setAttribute("id", "onesharerent");
    rentInput.setAttribute("required", true);
    rentInput.value = arrayshare[j].name;
    div_borders.append(rentInput);

    div_borders.append(document.createElement("br"));

    imageInput.addEventListener("input", function () {
      arrayshare[j].image = imageInput.value;
      updateLocalStorage();
    });

     rentInput.addEventListener("input", function () {
      arrayshare[j].name = rentInput.value;
      updateLocalStorage();
    });
  }
} else {
  console.log("Invalid or missing data in local storage");
}

// Function to update localStorage with the updated data
function updateLocalStorage() {
  if (localStorage) {
    localStorage.setItem("facilities_data", JSON.stringify(arrayofdata));
  }
}

 </script>
  
    </body>
</html>
